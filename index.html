<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<title>R√©f√©rendum qu√©b√©cois de 1995 ‚Äì Carte interactive</title>

<link rel="icon" type="image/png" href="fleur.png">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>

<!-- ‚úÖ Google Font : Ledger -->
<link href="https://fonts.googleapis.com/css2?family=Ledger&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    font-family: 'Ledger', serif;
  }
  #map {
    height: 100vh;
    width: 100%;
  }
  /* Optionnel: rendre le menu un peu plus lisible */
  .leaflet-control-layers {
    font-size: 14px;
  }
</style>
</head>

<body>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
/* ======================
   CARTE DE BASE
====================== */
const map = L.map('map').setView([46.8, -71.2], 6);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; OpenStreetMap'
}).addTo(map);

/* ======================
   GROUPES (CAT√âGORIES)
====================== */
const layerInstitution = L.layerGroup().addTo(map);
const layerMedia       = L.layerGroup().addTo(map);
const layerOui         = L.layerGroup().addTo(map);
const layerNon         = L.layerGroup().addTo(map);
const layerSymbolique  = L.layerGroup().addTo(map);

/* ======================
   IC√îNES
====================== */
const EMOJI_SIZE = 36;

function bigEmojiIcon(emoji) {
  return L.divIcon({
    html: `<span style="font-size:${EMOJI_SIZE}px; line-height:${EMOJI_SIZE}px;">${emoji}</span>`,
    className: "",
    iconSize: [EMOJI_SIZE, EMOJI_SIZE],
    iconAnchor: [EMOJI_SIZE / 2, EMOJI_SIZE],
    popupAnchor: [0, -EMOJI_SIZE]
  });
}

const iconInstitution = bigEmojiIcon("üèõÔ∏è");
const iconMedia       = bigEmojiIcon("üì∞");
const iconCanada      = bigEmojiIcon("üá®üá¶");
const iconStar        = bigEmojiIcon("‚≠ê");

// ‚úÖ Fleur de lys BLEUE (ton image)
const LYS_SIZE = 36;
const iconLys = L.icon({
  iconUrl: "fleur.png",
  iconSize: [LYS_SIZE, LYS_SIZE],
  iconAnchor: [LYS_SIZE / 2, LYS_SIZE],
  popupAnchor: [0, -LYS_SIZE]
});

/* ======================
   FONCTION AJOUT MARKER
====================== */
function addMarker(layerGroup, lat, lng, icon, title, text) {
  return L.marker([lat, lng], { icon })
    .addTo(layerGroup)
    .bindPopup(`<h3>${title}</h3><p>${text}</p>`)
    .on('click', function () {
      map.setView([lat, lng], 11);
    });
}

/* ======================
   LIEUX INSTITUTIONNELS (Qu√©bec)
====================== */
addMarker(
  layerInstitution,
  46.8080, -71.2170,
  iconInstitution,
  "Assembl√©e nationale du Qu√©bec",
  `
  <img src="img/assemblee-nationale.jpg"
       style="width:220px; max-width:100%; border-radius:10px; display:block; margin:0 0 8px 0;"
       loading="lazy">
  L‚ÄôAssembl√©e nationale constitue le c≈ìur institutionnel du pouvoir politique qu√©b√©cois. En 1995, elle est le lieu o√π se cristallisent les d√©bats constitutionnels et o√π s‚Äô√©labore le projet souverainiste port√© par le gouvernement du Parti qu√©b√©cois. Les analyses de la dynamique √âtat‚Äìsoci√©t√© montrent que la souverainet√© est pens√©e comme l‚Äôaboutissement d‚Äôun processus de renforcement de l‚Äô√âtat qu√©b√©cois depuis la R√©volution tranquille.<br><br>
  <b>Source :</b> Alain-G. Gagnon, <i>Qu√©bec : √âtat et soci√©t√©</i>.
  `
);



addMarker(
  layerInstitution,
  46.8065, -71.2164,
  iconInstitution,
  "√âdifice Honor√©-Mercier",
  `
  <img src="img/edifice-honore-mercier.jpg"
       style="width:220px; max-width:100%; border-radius:10px; display:block; margin:0 0 8px 0;"
       loading="lazy">
  Si√®ge du Conseil ex√©cutif, l‚Äô√©difice Honor√©-Mercier symbolise le pouvoir gouvernemental exerc√© par le Parti qu√©b√©cois durant la campagne r√©f√©rendaire. Il repr√©sente le lieu de coordination politique o√π s‚Äôarticulent √† la fois la strat√©gie r√©f√©rendaire et la pr√©paration d‚Äôun √©ventuel passage √† la souverainet√©.<br><br>
  <b>Source :</b> Alain-G. Gagnon.
  `
);

/* ======================
   CIRCONSCRIPTIONS ET DYNAMIQUES DU VOTE
   (OUI = iconLys ; NON = iconCanada)
====================== */
addMarker(
  layerNon,
  45.5280, -73.6100,
  iconCanada,
  "Acadie (Montr√©al) ‚Äì 78,78 % NON",
  `
  <img src="img/acadie.jpg"
       style="width:220px; max-width:100%; border-radius:10px; display:block; margin:0 0 8px 0;"
       loading="lazy">
  La circonscription d‚ÄôAcadie est embl√©matique du vote massif en faveur du NON dans l‚Äôouest et le centre de Montr√©al. Les r√©sultats montrent une forte corr√©lation entre comportement √©lectoral, composition linguistique et dynamique identitaire. Cette circonscription illustre le poids d√©cisif du vote non francophone dans l‚Äôissue finale du r√©f√©rendum.<br><br>
  <b>Source :</b> √âlections Qu√©bec ; Pierre Drouilly.
  `
);

addMarker(
  layerNon,
  45.4946, -73.6565,
  iconCanada,
  "D‚ÄôArcy-McGee (Montr√©al) ‚Äì 96,38 % NON",
  `
  <img src="img/darcy.jpg"
       style="width:220px; max-width:100%; border-radius:10px; display:block; margin:0 0 8px 0;"
       loading="lazy">
  La circonscription de D‚ÄôArcy-McGee constitue le cas le plus extr√™me de vote f√©d√©raliste lors du r√©f√©rendum de 1995. Avec 96,38&nbsp;% de votes en faveur du NON, elle illustre de mani√®re spectaculaire la concentration territoriale du rejet du projet souverainiste √† Montr√©al, fortement corr√©l√©e √† la pr√©sence de communaut√©s non francophones.<br><br>
  <b>R√©sultats :</b> OUI 3,62&nbsp;% ‚Äî NON 96,38&nbsp;%<br>
  <b>Source :</b> √âlections Qu√©bec, R√©f√©rendum de 1995.
  `
);

addMarker(
  layerOui,
  48.4284, -71.0526,
  iconLys,
  "Chicoutimi ‚Äì 68,87 % OUI",
  `
  <img src="img/chicoutimi.jpg"
       style="width:220px; max-width:100%; border-radius:10px; display:block; margin:0 0 8px 0;"
       loading="lazy">
  Chicoutimi est l‚Äôune des circonscriptions les plus fortement souverainistes du Qu√©bec lors du r√©f√©rendum de 1995. Avec pr√®s de 69&nbsp;% de votes pour le OUI, elle incarne l‚Äôappui massif des r√©gions du Saguenay‚ÄìLac-Saint-Jean au projet souverainiste, souvent interpr√©t√© comme l‚Äôexpression d‚Äôun nationalisme r√©gional fortement enracin√©.<br><br>
  <b>R√©sultats :</b> OUI 68,87&nbsp;% ‚Äî NON 31,13&nbsp;%<br>
  <b>Source :</b> √âlections Qu√©bec, R√©f√©rendum de 1995.
  `
);


addMarker(
  layerNon,
  46.1235, -70.6794,
  iconCanada,
  "Beauce-Sud ‚Äì 57,54 % NON",
  `
  <img src="img/beauce-sud.jpg"
       style="width:220px; max-width:100%; border-radius:10px; display:block; margin:0 0 8px 0;"
       loading="lazy">
  Beauce-Sud repr√©sente un profil distinct, celui d‚Äôune r√©gion majoritairement francophone mais n√©anmoins favorable au NON. Ce r√©sultat souligne que le clivage r√©f√©rendaire ne se r√©duit pas uniquement √† la langue, mais qu‚Äôil int√®gre aussi des facteurs √©conomiques, culturels et id√©ologiques.<br><br>
  <b>Source :</b> √âlections Qu√©bec ; Pierre Drouilly.
  `
);


addMarker(
  layerOui,
  45.5210, -73.5800,
  iconLys,
  "Laurier‚ÄìSainte-Marie",
  `
  <img src="img/laurier.jpg"
       style="width:220px; max-width:100%; border-radius:10px; display:block; margin:0 0 8px 0;"
       loading="lazy">
  Cette circonscription illustre un vote urbain francophone plus favorable au OUI, contrastant avec les secteurs montr√©alais domin√©s par le NON. Elle permet de nuancer la lecture strictement linguistique du vote en montrant l‚Äôimportance des dynamiques sociales et politiques propres aux quartiers centraux.<br><br>
  <b>Source :</b> √âlections Qu√©bec ; Pierre Drouilly.
  `
);


/* ======================
   LIEUX SYMBOLIQUES ET DISCURSIFS
====================== */
addMarker(
  layerSymbolique,
  45.5049, -73.5606,
  iconStar,
  "Palais des congr√®s de Montr√©al",
  `
  <img src="img/palais.jpg"
       style="width:220px; max-width:100%; border-radius:10px; display:block; margin:0 0 8px 0;"
       loading="lazy">
  Le Palais des congr√®s est le lieu o√π Jacques Parizeau prononce son allocution le soir du 30 octobre 1995. Ce discours devient un moment charni√®re de l‚Äôhistoire politique qu√©b√©coise en raison de ses propos sur ¬´ l‚Äôargent et les votes ethniques ¬ª, r√©v√©lant les tensions identitaires au c≈ìur du d√©bat r√©f√©rendaire.<br><br>
  <b>Source :</b> Discours de Jacques Parizeau (30 octobre 1995) ; Carol-Ann Bellefeuille.
  `
);


addMarker(
  layerSymbolique,
  45.5017, -73.5726,
  iconStar,
  "Place du Canada",
  `
  <img src="img/place.jpg"
       style="width:220px; max-width:100%; border-radius:10px; display:block; margin:0 0 8px 0;"
       loading="lazy">
  La Place du Canada constitue un espace public symbolique de mobilisation et de visibilit√© politique au centre-ville de Montr√©al. Elle illustre l‚Äôoccupation de l‚Äôespace urbain comme outil de l√©gitimation et de mise en sc√®ne des positions politiques durant la campagne r√©f√©rendaire.<br><br>
  <b>Source :</b> Carol-Ann Bellefeuille.
  `
);


/* ======================
   LIEUX M√âDIATIQUES
====================== */
addMarker(
  layerMedia,
  45.5316, -73.5735,
  iconMedia,
  "Maison de Radio-Canada",
  `
  <img src="img/maison.jpg"
       style="width:220px; max-width:100%; border-radius:10px; display:block; margin:0 0 8px 0;"
       loading="lazy">
  La Maison de Radio-Canada joue un r√¥le central dans la couverture m√©diatique du r√©f√©rendum de 1995. En tant que m√©dia public, elle participe √† la structuration du d√©bat et √† la diffusion des discours politiques, tout en √©tant au c≈ìur des critiques concernant la neutralit√© et l‚Äôimpact des m√©dias dans un contexte fortement polaris√©.<br><br>
  <b>Source :</b> Carol-Ann Bellefeuille.
  `
);

addMarker(
  layerMedia,
  45.5097, -73.5683,
  iconMedia,
  "La Presse",
  `
  <img src="img/presse.jpg"
       style="width:220px; max-width:100%; border-radius:10px; display:block; margin:0 0 8px 0;"
       loading="lazy">
  La Presse est un acteur m√©diatique majeur du camp francophone lors du r√©f√©rendum de 1995. Son traitement du r√©f√©rendum contribue √† fa√ßonner l‚Äôopinion publique et √† encadrer le d√©bat dans des termes √† la fois politiques et identitaires, notamment dans la r√©ception du discours de Jacques Parizeau.<br><br>
  <b>Source :</b> Carol-Ann Bellefeuille.
  `
);

/* ======================
   MENU (FILTRE PAR CAT√âGORIES)
====================== */
/* ======================
   MENU (FILTRE PAR CAT√âGORIES) ‚Äî version robuste
====================== */

// Libell√© HTML (sans backticks dans l'objet)
const labelOui =
  '<img src="fleur.png" style="height:18px; vertical-align:middle; margin-right:6px;">' +
  'Souverainistes (OUI)';

const overlays = {};
overlays["üèõÔ∏è Institutionnels"]   = layerInstitution;
overlays["üì∞ M√©diatiques"]       = layerMedia;
overlays[labelOui]              = layerOui;
overlays["üá®üá¶ F√©d√©ralistes (NON)"] = layerNon;
overlays["‚≠ê Symboliques"]       = layerSymbolique;

L.control.layers(null, overlays, { collapsed: false }).addTo(map);


/* ======================
   POPUP D‚ÄôINTRODUCTION
====================== */
const introPopup = L.popup({
  maxWidth: 450,
  minWidth: 350,
  closeButton: true,
  autoClose: true,
  closeOnClick: true,
  className: "intro-popup"
})
.setLatLng([46.8, -71.2])
.setContent(`
  <h2>R√©f√©rendum qu√©b√©cois de 1995</h2>
  <p>
    Cette carte interactive pr√©sente les lieux institutionnels, m√©diatiques
    et symboliques ayant marqu√© la campagne r√©f√©rendaire de 1995, ainsi que
    certaines dynamiques territoriales du vote.
  </p>
  <p>
    Utilise le menu (en haut √† droite) pour afficher ou masquer des cat√©gories,
    puis clique sur les marqueurs pour zoomer sur les lieux.
  </p>
  <p style="font-size:0.9em; color:#555;">
    (Clique n‚Äôimporte o√π sur la carte pour fermer cette fen√™tre)
  </p>
`)
.openOn(map);

// üëâ D√®s que l‚Äôutilisateur clique sur la carte, la popup dispara√Æt
map.once("click", function () {
  map.closePopup(introPopup);
});

/* ======================
   G√âOLOCALISATION UTILISATEUR
====================== */

map.locate({ setView: false, maxZoom: 12 });

map.on('locationfound', function (e) {
  // Cercle de pr√©cision
  const radius = e.accuracy;

  L.circle(e.latlng, {
    radius: radius,
    color: '#3366cc',
    fillColor: '#3366cc',
    fillOpacity: 0.15
  }).addTo(map);

  // Marqueur position
  L.marker(e.latlng)
    .addTo(map)
    .bindPopup("üìç Vous √™tes ici")
    .openPopup();

  // Centrer la carte
  map.setView(e.latlng, 10);
});

map.on('locationerror', function () {
  alert("La g√©olocalisation n‚Äôa pas pu √™tre activ√©e.");
});


</script>

</body>
</html>
